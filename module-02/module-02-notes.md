<!-- Ethical Hacking Module 02-->
<!-- by Phillip David Stearns 2019-->

# Ethical Hacking Module 2:

![](images/kali.jpg)

## Getting Started with Kali Linux

This is the second installment of a series of ethical hacking courses for folks with non-technical backgrounds.

## What we’re covering today:

* package managers
* shasum hash and signature verification
* burning a Kali iso to a flash drive
* configuring encrypted persistence
* getting familiar with kali


## What you can expect to take away

* a USB thumbdrive capable of turning any system into a penetration testing platform.
* a USB wifi adapter capable of short range attacks on WiFi routers

## Package Managers

![](images/managers.gif)

### Homebrew for OSX

**Package Managers** are tools that allow system admins to quickly and gracefully install, remove and update installed software packages.

You may have noticed that the installation process for most apps on OSX is as simple as downloading the .app package and moving it to the Applications folder. Others may ask for your permission to write files to disk.

When you want to remove an application, sometimes it's not simply enough to drag and drop the app in the trash. There are files stored elsewhere that remain.

There are times when you want to update all your applications at once. Opening each and checking for updates is a pain.

These are cases where a package manager comes in handy.

[Homebrew](https://brew.sh/) is the missing package manager for OSX.

Get it now by running:

```
/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
```

### Install GPG tools

In order to securely download and verify Kali Linux, we need to have the wget and GPG installed. We can use our shiny new Homebrew utility to help us out.

```
brew install gpg wget
```

We'll use this to verify the code signature of our Kali sha256sums and the .iso itself.

### apt-get for Linux

The Linux command line interface package handling utility. For all the same reasons you'd want to use Homebrew on OSX. We'll get more into using this utility once we have Kali setup.

## Download Kali Linux Images Securely

![](images/secure.gif)

We're downloading a tool that contains tools that can be easily used for offensive purposes, one that has the ability to inflict serious harm on connected systems if not handled with care. To ensure the integrity of your security and the security of anything you might be hacking, it is absolutely necessary to verify your .iso files before you do anything else! The last thing we want is to infect ourselves and our friends or clients with malicious software.

I've taken the liberty of downloading all the necessary .iso files to speed things along. Let's get on to verifying them from step 3 on.

1. Create a folder for you Kali .iso and related files. Launch the `terminal.app` and `cd` into that directory.
2. Download the kali-linux-2018.4-amd64.iso file along with the SHA256SUMS and SHA256SUMS.gpg files from - [Kali Linux Download Server](https://cdimage.kali.org/current/)
3. Before verifying the checksums of the image, you must ensure that the SHA256SUMS file is the one generated by Kali.
4.  Download the Kali code signing keys:
```
wget -q -O - https://www.kali.org/archive-key.asc | gpg --import
```
5. Run `gpg --fingerprint 7D8D0BF6` and verify that the fingerprint matches the one below:

``` 
pub rsa4096 2012-03-05 [SC] [expires: 2021-02-03]
44C6 513A 8E4F B3D3 0875 F758 ED44 4FF0 7D8D 0BF6
uid [ unknown] Kali Linux Repository <devel@kali.org>
sub rsa4096 2012-03-05 [E] [expires: 2021-02-03]
```
	
6. Verify the signature by running `gpg --verify SHA256SUMS.gpg SHA256SUMS` and check that the output matches:

```
gpg: Signature made Tue 13 Feb 2018 03:33:53 AM EST
gpg: using RSA key 44C6513A8E4FB3D30875F758ED444FF07D8D0BF6
gpg: Good signature from "Kali Linux Repository <devel@kali.org>" [unknown]
gpg: WARNING: This key is not certified with a trusted signature!
gpg: There is no indication that the signature belongs to the owner.
Primary key fingerprint: 44C6 513A 8E4F B3D3 0875 F758 ED44 4FF0 7D8D 0BF6
```

If you don’t get that “Good signature” message or if the key ID doesn’t match, then you should stop the process and review whether you downloaded the images from a legitimate Kali mirror.

7. Finally, run `grep kali-linux-2018.4-amd64.iso kali-linux-2018.4-amd64.iso.txt.sha256sum | shasum -a 256 -c` and verify that you get:

```
kali-linux-2018.4-amd64.iso: OK
```
8. If you're super paranoid you can "manually" check that `shasum -a 256 kali-linux-2018.4-amd64.iso` matches the sha256sum hash provided:

```
7c65d6a319448efe4ee1be5b5a93d48ef30687d4e3f507896b46b9c2226a0ed0
```
Phew! Our files are legit and untampered. Straight from the source!

## Writing our Kali .iso to our USB drive

![](images/copy.gif)

We're going to use the `dd` command to write the .iso to our thumbdrive.

>
WARNING: Although the process of imaging Kali on a USB drive is very easy, you can just as easily overwrite a disk drive you didn’t intend to with dd if you do not understand what you are doing, or if you specify an incorrect output path. Double-check what you’re doing before you do it, it’ll be too late afterwards.
>
Consider yourself warned.

Flag me down for help if you're unsure of any of the following steps:

1. **_WITHOUT_** the USB drive connected, launch `terminal.app` and run `diskutil list`.
2. Make note of the devices listed. You'll see your drives labelled `/dev/disk0` and `/dev/disk1`, etc.
3. Plug the USB thumbdrive in and run `diskutil list` again.
4. Note the label of the new device as well as the size. We're using 16GB drives so something in the ballpark of 15.6GB is about right for the size. Double check yourself and repeat steps 1-3.
5. Unmount the drive. For example, if your USB drive showed up at `/dev/disk7` you would run:

```
diskutil unmountDisk /dev/disk7
```

6. Proceed to (carefully!) burn image the Kali ISO file on the USB device. The following command assumes that your USB drive is on the path `/dev/disk6`, and you’re in the same directory with your Kali Linux ISO, which is named “kali-linux-2018.4-amd64.iso”:

```
sudo dd if=kali-linux-2018.4-amd64.iso of=/dev/disk7 bs=1m
```

7. `dd` will not print any feedback to the terminal so all we can do now is wait it out. Do sudoku puzzle, make some tea, catch up on the news. Once `dd` is finished, the output will look something like this:

```
2911+1 records in
2911+1 records out
3053371392 bytes transferred in 2151.132182 secs (1419425 bytes/sec)
```

8. To boot from our drive, hold down **option** immediately after powering the device up. Our live boot will show up as EFI.

## Setting up Encrypted Persistence

![](images/encryption.gif)